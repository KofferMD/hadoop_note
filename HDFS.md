**Узлы HDFS**

Как мы знаем, Hadoop работает по принципу ведущий-ведомый. В HDFS 
также есть два типа узлов, которые работают аналогичным способом.
Это NameNodes и DataNodes.


1. HDFS Master(NameNode)
NameNode регулирует доступ к файлам для клиентов. Он обслуживает 
и управляет подчиненными узлами и назначает им задания. NameNode 
выполняет операции с пространством имен файловой системы, такие 
как открытие, закрытие и переименования файлов.


2. HDFS Slave(DataNodes)
В распределенной фаловой системе Hadoop, которая управляет 
хранением данных, существует n количество ведомых узлов, где n
может достигать 1000 или DataNode. Эти ведомые узлы являются
фактическими рабочими узлами и обслуживают запросы на чтение и
запись от клиентов файловой системы.
Они выполняют создание, удаление и репликацию блоков по команде
узла NameNode. После записи блока на DataNode он реплицирует его 
на другие DataNode, и этот процесс продолжается до тех пор, пока не 
будет создано необходимое кол-во реплик.


3. Hadoop HDFS Daemonds.
Для хранения данных на HDFS работают два демона:
***NameNode*** - это демон, который работает на всех мастерах. NameNode
хранит такие метаданные, как имя файлов, кол-во блоков, кол-во реплик,
расположение блоков, идентификаторы блоков и т.д. Эти метаданные
доступны в памяти мастера для более быстрого поиска данных. На локальном
диске копия метаданных доступна для хранения. Поэтому память NameNode 
должна быть высокой в соответсвии с требованиями.
***DataNode*** - это демон, работающий на ведомом узле. Это фактически
рабочие узлы, которые хранят данные.


**HDFS архитектура**

Существует единственный узел NameNode, который хранит метаданные, и
несколько узлов DataNode, который хранит меданные, и несколько узлов DataNode,
которые выполняют фактическую работу по хранению данных.

Чтобы прочитать или записать файл HDFS, клиент должен взаимодействовать с 
NameNode. Приложениями HDFS необходима модель доступа к файлам по принципу
"write-once-read-many". Файл однажды созданный и записанный, не может быть 
отредактирован.

NameNode хранит метаданные, а DataNode - фактические данные. 


**HDFS особенности**

1. Распределнное хранение
HDFS хранит данные распределенным образом. Она делит данные на небольшие
фрагменты и хранит их на разных DataNodes в кластере. Таким образом, 
распределенная файловая система Hadoop предоставляет MapReduce возможность 
обрабатывать подмножество больших наборов данных, разбитых на блоки, 
параллельно на нескольких узлах. MapReduce - это сердце Hadoop, но именно 
HDFS предоставляет ему эту возможность.

2. Блоки
HDFS разбивает огромные файлы на небольшие фрагменты, называемые блоками. 
Блок - это небольшая единица данных в файловой системе. Мы (клиент и админ)
не имеем никакого контроля над блоком, например, над его расположением. Все 
эти впоросы решает NameNode.

Размер блока HDFS по умолчанию составляет 128 МБ. Мы можем увеличить или 
уменшить размер блока в соотвествии с нашими потребностями. В отличии от 
файловой системы, где размер блока составляет 4 КБ.

Если размер данных меньше размера блока HDFS, то размер блока будет равен
размеру данных. 

Например, если размер файла состовляет 129 МБ, то для него будет создано 
2 блока. Один будет иметь стандартный размер 128 МБ, а другой 1 МБ, а не 
128 МБ, так как это приведет к потере места (здесь размер блока равен 
размеру данных). Hadoop достаточно умна, чтобы не тратить впустую оставшиеся
127 МБ. Поэтому он выделяет блок размером 1 МБ только для данных размером 1 МБ

Основное преимущество хранения данных в блоках такого размера заключается в 
том, что это экономит время обращения к диску, и еще одно преимущество - в 
обработке, так как mapper обрабатывает 1 блок за раз. Таким образом, один
mapper обрабатывает большие данные за один раз.

3. Репликация
Hadoop HDFS создает дубликаты каждого блока. Это известно как репликация. Все
блоки реплицируются и хранятся на разных DataNodes в кластере. Он старается 
поместить хотя бы одну реплику в другую стойку.

4. Высокя доступность (High Availavility)
Репликация блоков данных и их хранения на нескольких узлах кластера
обеспечивает высокую достпуность данных. Коэффициент репликации по умолчанию
равен 3, и мы можем изменить его на нужные значения в соотвествии с
требованиями, отредактировав файлы конфигурации hdfs-site.xml

5. Надежность данных
Данные в HDFS реплицируются. Благодаря репликации блоки доступны даже при
сбое узла или отказе оборудования. Если узел DataNode выходит из строя, то
блок доступен с другого узла DataNode, содержащего реплику этого блока. 

6. Отказоустойчивость
HDFS обеспечивает отказоустойчивый уровень хранения данных для Hadoop и 
других компонентов экосистемы.

HDFS работет с товарным оборудованием, которые имеет большие шансы выйти из
строя в любой момент. Поэтому для обеспечения высокой отказоустойчивости 
всей системы HDFS реплицирует и хранит данные в разных местах.

7. Масштабируемость
Вертикальное - добавление дисков.
Горизонтальное - добавление новых узлов.




Links:
Interview Que - https://data-flair.training/blogs/top-hdfs-interview-questions-and-answers/



